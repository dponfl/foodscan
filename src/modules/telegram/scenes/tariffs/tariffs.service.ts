import { Injectable } from '@nestjs/common';
import { IScene, MyContext } from '../../../../types';
import { CALLBACK_DATA, SCENES, WAITING_FOR_INPUT } from '../scenes.constants';
import { InlineKeyboard } from 'grammy';

@Injectable()
export class TariffsSceneService implements IScene {
  readonly SCENE_NAME = SCENES.TARIFFS;

  async handle(ctx: MyContext): Promise<void> {
    ctx.session.waitingForInput = null;
    ctx.session.sceneEntryTime = Date.now();
    ctx.session.currentScene = this.SCENE_NAME;

    const keyboard = new InlineKeyboard()
      .text('‚úÖ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø', CALLBACK_DATA.GO_TO_PAYMENT)
      .row()
      .text('üîô –ù–∞–∑–∞–¥', CALLBACK_DATA.GO_TO_MAIN_MENU);

    const text = `üí° –ó–¥–æ—Ä–æ–≤—å–µ ‚Äî —ç—Ç–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è\\.

–° E\\-scanner —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å:

‚úÖ –ü—Ä–æ–≤–µ—Ä–∫—É —Å–æ—Å—Ç–∞–≤–∞ –ª—é–±–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ ¬†
‚ö†Ô∏è –í—ã—è–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–¥–Ω—ã—Ö –¥–æ–±–∞–≤–æ–∫ –∏ –ï\\-—à–µ–∫ ¬†
ü•ó –°–æ–≤–µ—Ç—ã: —á—Ç–æ –ù–ï –µ—Å—Ç—å, —á–µ–º –∑–∞–º–µ–Ω–∏—Ç—å –∏ –∫–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–º ¬†
üì∑ –í—Å—ë –ø—Ä–æ—Å—Ç–æ: —Å—Ñ–æ—Ç–∫–∞–ª ‚Äî –ø–æ–ª—É—á–∏–ª —á–µ—Å—Ç–Ω—ã–π —Ä–∞–∑–±–æ—Ä

\\-\\-\\-

üéÅ –ü—Ä–æ–±–Ω–∞—è –≤–µ—Ä—Å–∏—è:
–¢—ã –ø–æ–ª—É—á–∞–µ—à—å 3 –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å –ø–æ–ª—å–∑—É —Å–µ—Ä–≤–∏—Å–∞\\.

\\-\\-\\-

üí≥ –î–∞–ª—å—à–µ:

‚Ä¢ 1 –ø—Ä–æ–≤–µ—Ä–∫–∞ ‚Äî 39 ‚ÇΩ¬†\\(23 ‚≠êÔ∏è\\)
‚Ä¢ 10 –ø—Ä–æ–≤–µ—Ä–æ–∫ ‚Äî 299 ‚ÇΩ¬†\\(175 ‚≠êÔ∏è\\)
‚Ä¢ –ü–æ–¥–ø–∏—Å–∫–∞ \\(–±–µ–∑–ª–∏–º–∏—Ç\\) ‚Äî 549 ‚ÇΩ –≤ –º–µ—Å—è—Ü \\(323 ‚≠êÔ∏è\\) –∏–ª–∏ 3 490 ‚ÇΩ –≤ –≥–æ–¥ \\(2 053 ‚≠êÔ∏è\\)

\\-\\-\\-

üôå –ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç –æ–ø–ª–∞—Ç–∏—Ç—å?

‚Äì –¢—ã –µ—à—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî –∏ –∑–¥–æ—Ä–æ–≤—å–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —ç—Ç–∏—Ö —Ä–µ—à–µ–Ω–∏–π¬†¬†
‚Äì –°–µ—Ä–≤–∏—Å —ç–∫–æ–Ω–æ–º–∏—Ç —Ç–≤–æ–µ –≤—Ä–µ–º—è –∏ –±–µ—Ä–µ–∂–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–º¬†¬†
‚Äì –¶–µ–Ω–∞ –º–µ–Ω—å—à–µ, —á–µ–º –∑–∞ –∫–æ—Ñ–µ, –∞ –ø–æ–ª—å–∑–∞ ‚Äî –Ω–∞ –≥–æ–¥—ã –≤–ø–µ—Ä—ë–¥¬†¬†
‚Äì –≠—Ç–æ –≤–ª–æ–∂–µ–Ω–∏–µ –≤ —Ç–≤–æ—ë —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ, —è—Å–Ω–æ—Å—Ç—å —É–º–∞ –∏ –¥–æ–ª–≥–æ–ª–µ—Ç–∏–µ

\\-\\-\\-

–°–¥–µ–ª–∞–π –ø–µ—Ä–≤—ã–π —à–∞–≥ –∫ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–º—É –ø–∏—Ç–∞–Ω–∏—é\\.
–ù–∞–∂–º–∏ üëâ /buy –∏–ª–∏ –∫–Ω–æ–ø–∫—É ¬´‚úÖ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø¬ª ‚Äî –∏ –Ω–∞—á–Ω–∏ –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ —Å–µ–±–µ —É–∂–µ —Å–µ–≥–æ–¥–Ω—è\\!`;

    // –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—à—ë–ª –ø–æ –∫–Ω–æ–ø–∫–µ
    if (ctx.callbackQuery) {
      // –°–Ω–∞—á–∞–ª–∞ –æ—Ç–≤–µ—á–∞–µ–º –Ω–∞ –Ω–∞–∂–∞—Ç–∏–µ, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å "–∑–∞–≥—Ä—É–∑–∫—É"
      await ctx.answerCallbackQuery();
      // –ó–∞—Ç–µ–º —É–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –Ω–∞–≥—Ä–æ–º–æ–∂–¥–µ–Ω–∏—è
      await ctx.deleteMessage();
    }

    await ctx.reply(text, {
      parse_mode: 'MarkdownV2',
      reply_markup: keyboard,
    });
  }
}
